/*
 * Copyright (c) 2016, Shinya Yagyu
 * All rights reserved.
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its
 *    contributors may be used to endorse or promote products derived from this
 *    software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

const TX_STRING: &str = "TISEZJUUKSTSX9KVQGXSYYLNDIBJDVRZSOFEHWJSDZLNUUNBDLHUODEGFZQTKOEXUMMQTOREUWQCSGGWRKALQDDZCQN9LBIEVKBFDCWBIDWD9DGVOJVCNUNWDDZFCIOICZZF9KIAYDCSKJWE99UPPLUQPUSWTDKTSSTJAQNYATUTXZPA9CCJRRNIRWXTAR9ECVYXC9AOHXHYVOS9LWDUOH9SDUAQBEYTMJIMUHJTGUSQTFPRLLXIDKOVZMONJHXPCD9FYLW9PN9LLPQBJRSEKVKKJB9JRTZCXSDBMJYAKDX99EGNLFZPKIADJQEIMCKRFQKIHGCJAHPL9JFJF9PHRKPCHBPN9LYQSC9TXOXAI9WBDIBNGFPLQS9BHTEVROMCAXXAXPVBAP9URJXIVZXIWWCMVDXGAFZOIRTJIMNIZEPGFMWXWOWRDUMHFRKL9LV9VJQIRZPVJSSKHXHHVZLRZYHGWQAVL9BMWKKFGZQEYJNCGROYYDIDULQVSXGVLTTZRLPSKPVIURJ9CJBTNAYCPHQTWTTKHXPABTYYCCVAZATEVED9PBJQTNOQEQQBTSATZJTVUTZPUWDYKROBROUVSPMDLUMEZWMPESEMQPSVTDZKATUTOAEVWCW9HIKKHMOQYJOUYLTFPERSKBVWARHGJNKUWGFZYF9WSTEHEQWCA9DTOTOTNDFGAEABKKBKEFLDELEOYPZTCVKOBIWA9HWTCQT9IGYVFAFAOLOJMRDZKCBYOCPGEGGZL9CGFURM9FJBLGLZJILNSFOBXLQOZWVLAZUFLGQNCAVJTBGVLZETETWGXLPSPWMMAEGORSDGPUSFRQ9AVWWZCFNKSAHIKJOMEWCCFGVYSDYNIXYYTKJTOKZUGLKNEXHWQ9HVFVJUGJJEDQACTWPSFOONTNCJRDQBSCGXVKWZIGDK9RGHKAHSTOJDJEHIAOF9MFLAZJXLUGQUAUGKQGQIXXNLAPRQNTNVDGXVZBSEFXVRR9ZQIZEWPXZFMXLJFTFKEPPAFJTMBLBWYAWJEIHUNATL9EHIJQTCCMQFHILGHGEVXKHDCNMAHDPUGBQYYBF9CRIKDVZZ9KIFELUUKPXPRIFVTZPXRBKJBRLEGUJKXZPYGXRKOAHROFXENAUAYOSQBJGMMHIDUNSYYGQSDJDKMPNBPTUWMIYZCWABYLDMTXAGWFYEXRGLOYVPNSOVYITEPCXMTMPVLBQPBNQUBITEM99KVRTPNAAWPR9RQYBLFZDVWYDJXQRGTVAFVE99KE9YSCETBIELIWPKZYFARSPVLTDKEAKLCKULZHLKOQZMVLFLF9QHT9LLS9QQODSFYUIPKSBVSKAJMVW9QUILQSKHZMAXGVHUJBMTATPIDHJVUBZWUOYNOOMEJVOUXHACUHDVKZ9ZDTSIHQOTOVUMEISMA9VZIFQTPBXXDHDLVLKZZHLYLPIE9SKOEJXAFDKICOYIOVVAEXC9VZSFSDTSHVEOSHIT9JHMBBPQTRGOREIYQSBCMHJQIXTTQWOCKMCSGBRTJRRYWPXAGELIFPG9YX9FNNYGSJXJYTHIMWSXZH9JQIYXKFXEOHOE9YNHJIDAJUGPENZHOIFEHBSCQITVFHUOESVXOJPCNTUZR9LVQCXYUW9DITEXPG9KWYMBZQQCESNFVUOBQGCRRKFHOEKTHDHUNRXADXUMCWFJMZTMHN9VWLZATB9FF9HBGLFITNNVFCQICPRSGVFAATWYJT9GUJIAHNNJBECYSWSGEJYLHJPUOYESLVIELBMSLRZJLPKDKFGAJSSWZCQDLFDEXWAPILHLNHKCRMPLQUYESAEIWWNBCEIYSOHKPILTXPAFIZ9JMKFKJHTLHRHGZQLCEVJJMJHWTUKMKOWTZWGVZGQAOAKVGXZEZBMYPVWUGYJBIFXBACZLADFFBZIXKWSZLDOCGRQAZDCFPRAZYXUMNRJ9UKUKRAVSVMCENDJABZITDQLNCXZNXCOHKLATFFXKP9FFDYSAXISISMVYPXPWYPVEAYRNAITWJSTGXRAMMZIZF9IUORREWSFUNZOXDVCMBZJAET9PVHCQTMDTVVXLXDIXFSHPXWKBZBDJAAXSDEFXPARBU9GJJABPMCD9LGQJLRIYKGQORGCDDABAIAQC9MZDQLXFSAOLNYMWCJODEEUSIHEVHQPAIFQL9ECBBVZPHYU9HDBOYXTKWOIRGHUJMVV9UKHHREDIU9CRZFUZKAMUVRIEMKEKIMAGXSMGTEJWCWWAMRPWNINTETOTRMODTORVEURRY9RTDYQIEW99999999999999999999999999999999999999999999CMRKHWD99A99999999C99999999TNFAKVBFHHMKQKKSNJRLDIYUIGOMEOADJLNS9JGKGUIHZHIUDNQMVYCA9SZCLQOEVJPUGQGWTMETLGMUQMAKHHHHTBHVWYSJSXRVBRMHVV9WUTNMNFVDWLHQGFELTKZOISREPUJXNRBIAQVQWCCKB9DEZEXS999999M9EZGRXJ9WYSZXNDZBAJZMJ9VAMUWWWANGIVFKCUNRB9GLZZKRIMEFUK9KEFZXYDGBQJIU9SQUM999999999999999999999999999999999999999999999999999999999999999999999999999999999999999";

const HASH_LENGTH: usize = 243;
const STATE_LENGTH: usize = 3 * HASH_LENGTH;
const TRYTE_LENGTH: usize = HASH_LENGTH / 3; 

const TX_LENGTH: usize = 2673;
const TRITS_LENGTH: usize = 3 * TX_LENGTH;

fn main() {
    let trits = tx2trit(TX_STRING);
    let state = absorb(trits, TRITS_LENGTH);
    let _tryte = hash2tryte(state);
}

const CHAR_9_U8: u8 = '9' as u8;
const CHAR_A_U8: u8 = 'A' as u8;
const CHAR_Z_U8: u8 = 'Z' as u8;

const TRYTE2TRIT_TABLE: [[i8; 3]; 27] = [
    [0, 0, 0], [1, 0, 0], [-1, 1, 0], [0, 1, 0], [1, 1, 0], [-1, -1, 1], [0, -1, 1], [1, -1, 1], [-1, 0, 1], [0, 0, 1], [1, 0, 1], [-1, 1, 1], [0, 1, 1], [1, 1, 1], [-1, -1, -1], [0, -1, -1], [1, -1, -1], [-1, 0, -1], [0, 0, -1], [1, 0, -1], [-1, 1, -1], [0, 1, -1], [1, 1, -1], [-1, -1, 0], [0, -1, 0], [1, -1, 0], [-1, 0, 0]
];

const INDICES: [usize; 730] = [
    0, 364, 728, 363, 727, 362, 726, 361, 725, 360, 724, 359, 723, 358, 722, 357, 721, 356, 720, 355, 719, 354, 718, 353, 717, 352, 716, 351, 715, 350, 714, 349, 713, 348, 712, 347, 711, 346, 710, 345, 709, 344, 708, 343, 707, 342, 706, 341, 705, 340, 704, 339, 703, 338, 702, 337, 701, 336, 700, 335, 699, 334, 698, 333, 697, 332, 696, 331, 695, 330, 694, 329, 693, 328, 692, 327, 691, 326, 690, 325, 689, 324, 688, 323, 687, 322, 686, 321, 685, 320, 684, 319, 683, 318, 682, 317, 681, 316, 680, 315, 679, 314, 678, 313, 677, 312, 676, 311, 675, 310, 674, 309, 673, 308, 672, 307, 671, 306, 670, 305, 669, 304, 668, 303, 667, 302, 666, 301, 665, 300, 664, 299, 663, 298, 662, 297, 661, 296, 660, 295, 659, 294, 658, 293, 657, 292, 656, 291, 655, 290, 654, 289, 653, 288, 652, 287, 651, 286, 650, 285, 649, 284, 648, 283, 647, 282, 646, 281, 645, 280, 644, 279, 643, 278, 642, 277, 641, 276, 640, 275, 639, 274, 638, 273, 637, 272, 636, 271, 635, 270, 634, 269, 633, 268, 632, 267, 631, 266, 630, 265, 629, 264, 628, 263, 627, 262, 626, 261, 625, 260, 624, 259, 623, 258, 622, 257, 621, 256, 620, 255, 619, 254, 618, 253, 617, 252, 616, 251, 615, 250, 614, 249, 613, 248, 612, 247, 611, 246, 610, 245, 609, 244, 608, 243, 607, 242, 606, 241, 605, 240, 604, 239, 603, 238, 602, 237, 601, 236, 600, 235, 599, 234, 598, 233, 597, 232, 596, 231, 595, 230, 594, 229, 593, 228, 592, 227, 591, 226, 590, 225, 589, 224, 588, 223, 587, 222, 586, 221, 585, 220, 584, 219, 583, 218, 582, 217, 581, 216, 580, 215, 579, 214, 578, 213, 577, 212, 576, 211, 575, 210, 574, 209, 573, 208, 572, 207, 571, 206, 570, 205, 569, 204, 568, 203, 567, 202, 566, 201, 565, 200, 564, 199, 563, 198, 562, 197, 561, 196, 560, 195, 559, 194, 558, 193, 557, 192, 556, 191, 555, 190, 554, 189, 553, 188, 552, 187, 551, 186, 550, 185, 549, 184, 548, 183, 547, 182, 546, 181, 545, 180, 544, 179, 543, 178, 542, 177, 541, 176, 540, 175, 539, 174, 538, 173, 537, 172, 536, 171, 535, 170, 534, 169, 533, 168, 532, 167, 531, 166, 530, 165, 529, 164, 528, 163, 527, 162, 526, 161, 525, 160, 524, 159, 523, 158, 522, 157, 521, 156, 520, 155, 519, 154, 518, 153, 517, 152, 516, 151, 515, 150, 514, 149, 513, 148, 512, 147, 511, 146, 510, 145, 509, 144, 508, 143, 507, 142, 506, 141, 505, 140, 504, 139, 503, 138, 502, 137, 501, 136, 500, 135, 499, 134, 498, 133, 497, 132, 496, 131, 495, 130, 494, 129, 493, 128, 492, 127, 491, 126, 490, 125, 489, 124, 488, 123, 487, 122, 486, 121, 485, 120, 484, 119, 483, 118, 482, 117, 481, 116, 480, 115, 479, 114, 478, 113, 477, 112, 476, 111, 475, 110, 474, 109, 473, 108, 472, 107, 471, 106, 470, 105, 469, 104, 468, 103, 467, 102, 466, 101, 465, 100, 464, 99, 463, 98, 462, 97, 461, 96, 460, 95, 459, 94, 458, 93, 457, 92, 456, 91, 455, 90, 454, 89, 453, 88, 452, 87, 451, 86, 450, 85, 449, 84, 448, 83, 447, 82, 446, 81, 445, 80, 444, 79, 443, 78, 442, 77, 441, 76, 440, 75, 439, 74, 438, 73, 437, 72, 436, 71, 435, 70, 434, 69, 433, 68, 432, 67, 431, 66, 430, 65, 429, 64, 428, 63, 427, 62, 426, 61, 425, 60, 424, 59, 423, 58, 422, 57, 421, 56, 420, 55, 419, 54, 418, 53, 417, 52, 416, 51, 415, 50, 414, 49, 413, 48, 412, 47, 411, 46, 410, 45, 409, 44, 408, 43, 407, 42, 406, 41, 405, 40, 404, 39, 403, 38, 402, 37, 401, 36, 400, 35, 399, 34, 398, 33, 397, 32, 396, 31, 395, 30, 394, 29, 393, 28, 392, 27, 391, 26, 390, 25, 389, 24, 388, 23, 387, 22, 386, 21, 385, 20, 384, 19, 383, 18, 382, 17, 381, 16, 380, 15, 379, 14, 378, 13, 377, 12, 376, 11, 375, 10, 374, 9, 373, 8, 372, 7, 371, 6, 370, 5, 369, 4, 368, 3, 367, 2, 366, 1, 365, 0
];

const TRUTH_TABLE: [i8; 11] = [ 1, 0, -1, 0, 1, -1, 0, 0, -1, 1, 0 ];

const H_BITS_128: u128 = 0x0000000000000000_0000000000000000;
const L_BITS_128: u128 = 0xFFFFFFFFFFFFFFFF_FFFFFFFFFFFFFFFF;

fn tx2trit(tx: &str) -> [i8; TRITS_LENGTH] {
    println!("tx2trit");

    let tx_bytes = tx.as_bytes();
    if tx_bytes.len() != TX_LENGTH {
        panic!("tx len must be {} but {}", TX_LENGTH, tx_bytes.len());
    }

    let mut trits: [i8; TRITS_LENGTH] = [0; TRITS_LENGTH];
    for count in 0..TX_LENGTH {
        if !(tx_bytes[count] == CHAR_9_U8 || (tx_bytes[count] >= CHAR_A_U8 && tx_bytes[count] <= CHAR_Z_U8)) {
            panic!("illegal tx char {}", tx_bytes[count]);
        }

        // tx_bytes 9 -> 0, A -> 1, ... Z -> 34
        let mut ch: usize = 0;
        if tx_bytes[count] != CHAR_9_U8 {
            ch = (tx_bytes[count] - CHAR_A_U8 + 1) as usize;
        }

        trits[count * 3] = TRYTE2TRIT_TABLE[ch][0];
        trits[count * 3 + 1] = TRYTE2TRIT_TABLE[ch][1];
        trits[count * 3 + 2] = TRYTE2TRIT_TABLE[ch][2];
    }

    trits
}

fn transform(state: [i8; STATE_LENGTH]) -> [i8; STATE_LENGTH] {
    let mut transformed_state: [i8; STATE_LENGTH] = state;
    let mut round = 0;
    loop {
        if 27 <= round { break; }

        let copy_state = transformed_state;
        for i in 0..STATE_LENGTH {
            let aa = INDICES[i];
            let bb = INDICES[i + 1];
            let cc = (copy_state[aa] + (copy_state[bb] << 2) + 5) as usize;
            transformed_state[i] = TRUTH_TABLE[cc];
        }
        round += 1;
    }

    transformed_state
}

fn absorb(trits: [i8; TRITS_LENGTH], size: usize) -> [i8; STATE_LENGTH] {

    let mut state: [i8; STATE_LENGTH] = [0; STATE_LENGTH];
    let mut offset = 0;
    loop {
        if offset >= size { break; }
        
        let mut len = HASH_LENGTH;
        if size < HASH_LENGTH {
            len = size;
        }
        
        for count in 0..len {
            state[count] = trits[count + offset]
        }

        let transformed_state = transform(state);
        state = transformed_state;

        offset = offset + len;
    }

    state
}


fn hash2tryte(hash: [i8; STATE_LENGTH]) -> [u8; TRYTE_LENGTH]{
    let mut tryte: [u8; TRYTE_LENGTH] = [0; TRYTE_LENGTH];
    for count in 0..TRYTE_LENGTH {
        let mut n = hash[count * 3] + hash[count * 3 + 1] * 3 + hash[count * 3 + 2] * 9;
        if n < 0 {
            n = n + 27;
        }

        if n > 27 || n < 0 {
            panic!("illegal hash. {}", n);
        }

        if n == 0 {
            tryte[count] = CHAR_9_U8;
        } else {
            tryte[count] = n as u8 + CHAR_A_U8 - 1;
        }
    }

    tryte
}

fn pwork(tx: &str, mwm: i64) -> (i128, [i8; HASH_LENGTH]){

    let trits = tx2trit(tx);
    let mid = absorb(trits, TX_LENGTH * 3 - HASH_LENGTH);

    let (count, nonce) = pwork_child(mid, mwm, 0);

    let mut count_sse = 0;
    if count >= 0 {
        count_sse = count;
    } else {
        count_sse += -1 * count + 1;
    }

    (count_sse, nonce)
}

/*
long long int pwork(char tx[], int mwm, char nonce[])
{
    long long int countSSE = 0;
    int i = 0;
    char trits[TX_LENGTH * 3] = { 0 }, mid[STATE_LENGTH] = { 0 };

    tx2trit(tx, trits);
    absorb(mid, trits, TX_LENGTH * 3 - HASH_LENGTH);
    int procs = getCpuNum();
    if (procs>1){
        // procs--;
    }
    fprintf(stderr, "core num:%d\n", procs);
#ifdef _WIN32
    HANDLE *thread = (HANDLE*)calloc(sizeof(HANDLE), procs);
#else
    pthread_t* thread = (pthread_t*)calloc(sizeof(pthread_t), procs);
#endif
    PARAM* p = (PARAM*)calloc(sizeof(PARAM), procs);
    for (i = 0; i < procs; i++) {
        p[i].mid = mid;
        p[i].mwm = mwm;
        p[i].n = i;
#ifdef _WIN32
        unsigned int id=0;
        thread[i] = (HANDLE)_beginthreadex(NULL, 0, pwork_, (LPVOID)&p[i], 0, NULL);
        if (thread[i]==NULL) {
#else
        int ret = pthread_create(&thread[i], NULL, pwork_, &p[i]);
        if (ret != 0) {
#endif
            fprintf(stderr, "can not create thread\n");
            exit(EXIT_FAILURE);
        }
    }
    for (i = 0; i < procs; i++) {
#ifdef _WIN32
        int ret = WaitForSingleObject( thread[i], INFINITE );
        CloseHandle(thread[i]);
        if (ret == WAIT_FAILED) {
#else
        int ret = pthread_join(thread[i], NULL);
        if (ret != 0) {
#endif
            fprintf(stderr, "can not join thread\n");
            exit(EXIT_FAILURE);
        }
        if (p[i].count >= 0) {
            memcpy(nonce, p[i].nonce, HASH_LENGTH);
            countSSE += p[i].count;
        }
        else {
            countSSE += -p[i].count + 1;
        }
    }
    free(thread);
    free(p);

    return countSSE;
}
*/

fn pwork_child(mid: [i8; STATE_LENGTH], mvm: i64, n: i64) -> (i128, [i8; HASH_LENGTH]) {
    // 

    //let lmid: [u128; STATE_LENGTH] = [0; STATE_LENGTH];
    //let hmid: [u128; STATE_LENGTH] = [0; STATE_LENGTH];

    /*
    #define LOW00 0xDB6DB6DB6DB6DB6DuLL //0b1101101101101101101101101101101101101101101101101101101101101101L;
    #define HIGH00 0xB6DB6DB6DB6DB6DBuLL //0b1011011011011011011011011011011011011011011011011011011011011011L;
    #define LOW10 0xF1F8FC7E3F1F8FC7uLL //0b1111000111111000111111000111111000111111000111111000111111000111L;
    #define HIGH10 0x8FC7E3F1F8FC7E3FuLL //0b1000111111000111111000111111000111111000111111000111111000111111L;
    #define LOW20 0x7FFFE00FFFFC01FFuLL //0b0111111111111111111000000000111111111111111111000000000111111111L;
    #define HIGH20 0xFFC01FFFF803FFFFuLL //0b1111111111000000000111111111111111111000000000111111111111111111L;
    #define LOW30 0xFFC0000007FFFFFFuLL //0b1111111111000000000000000000000000000111111111111111111111111111L;
    #define HIGH30 0x003FFFFFFFFFFFFFuLL //0b0000000000111111111111111111111111111111111111111111111111111111L;
    #define LOW40 0xFFFFFFFFFFFFFFFFuLL //0b1111111111111111111111111111111111111111111111111111111111111111L;
    #define HIGH40 0xFFFFFFFFFFFFFFFFuLL //0b1111111111111111111111111111111111111111111111111111111111111111L;
    
    #define LOW01 0x6DB6DB6DB6DB6DB6uLL //0b0110110110110110110110110110110110110110110110110110110110110110
    #define HIGH01 0xDB6DB6DB6DB6DB6DuLL //0b1101101101101101101101101101101101101101101101101101101101101101
    #define LOW11 0xF8FC7E3F1F8FC7E3uLL //0b1111100011111100011111100011111100011111100011111100011111100011
    #define HIGH11 0xC7E3F1F8FC7E3F1FuLL //0b1100011111100011111100011111100011111100011111100011111100011111
    #define LOW21 0xC01FFFF803FFFF00uLL //0b1100000000011111111111111111100000000011111111111111111100000000
    #define HIGH21 0x3FFFF007FFFE00FFuLL //0b0011111111111111111100000000011111111111111111100000000011111111
    #define LOW31 0x00000FFFFFFFFFFFuLL //0b0000000000000000000011111111111111111111111111111111111111111111
    #define HIGH31 0xFFFFFFFFFFFE0000uLL //0b1111111111111111111111111111111111111111111111100000000000000000
    #define LOW41 0x000000000001FFFFuLL //0b0000000000000000000000000000000000000000000000011111111111111111
    #define HIGH41 0xFFFFFFFFFFFFFFFFuLL //0b1111111111111111111111111111111111111111111111111111111111111111
*/
    let (mut lmid, mut hmid) = para(mid);
    lmid[0] = 0x6DB6DB6DB6DB6DB6_DB6DB6DB6DB6DB6D; // LOW01  LOW00
    hmid[0] = 0xDB6DB6DB6DB6DB6D_B6DB6DB6DB6DB6DB; // HIGH01 HIGH00
    lmid[1] = 0xF8FC7E3F1F8FC7E3_F1F8FC7E3F1F8FC7; // LOW11  LOW10
    hmid[1] = 0xC7E3F1F8FC7E3F1F_8FC7E3F1F8FC7E3F; // HIGH11 HIGH10
    lmid[2] = 0xC01FFFF803FFFF00_7FFFE00FFFFC01FF; // LOW21  LOW20
    hmid[2] = 0x3FFFF007FFFE00FF_FFC01FFFF803FFFF; // HIGH21 HIGH20
    lmid[3] = 0x00000FFFFFFFFFFF_FFC0000007FFFFFF; // LOW31  LOW30
    hmid[3] = 0xFFFFFFFFFFFE0000_003FFFFFFFFFFFFF; // HIGH31 HIGH30
    lmid[4] = 0x000000000001FFFF_FFFFFFFFFFFFFFFF; // LOW41  LOW40
    hmid[4] = 0xFFFFFFFFFFFFFFFF_FFFFFFFFFFFFFFFF; // HIGH41 HIGH40
    
    let (lmid2, hmid2) = incrN128(n, lmid, hmid);
    let (count, nonce) = loop_cpu(lmid2, hmid2, mvm);
    
    (count, nonce)
}


fn loop_cpu(lmid: [u128; STATE_LENGTH], hmid: [u128; STATE_LENGTH], mvm: i64) -> (i128, [i8; HASH_LENGTH]) {
    //let n = 0;
    //let j = 0;
    //let i = 0;
    let mut lcpy: [u128; STATE_LENGTH] = [0; STATE_LENGTH];
    let mut hcpy: [u128; STATE_LENGTH] = [0; STATE_LENGTH];

    let mut i = 0;
    loop {
        if incr(lmid, hmid) {
            break;
        }
        for j in 0..STATE_LENGTH {
            lcpy[j] = lmid[j];
            hcpy[j] = hmid[j];
        }

       let (lcpy_tr, hcp_tr) = transform64(lcpy, hcpy);
/*
        if ((n = check(lcpy + STATE_LENGTH, hcpy + STATE_LENGTH, m)) >= 0) {
            seri(lmid, hmid, n, nonce);
            return i * 128;
        }
        int stop_=readStop();
        if (stop_) {
            return -i * 128 - 1;
        }
*/
        i += 1;
    }

    let dummy = [0; HASH_LENGTH];
    (-i * 128 - 1, dummy)
}

/*
long long int loop_cpu(__m128i* lmid, __m128i* hmid, int m, char* nonce)
{
    int n = 0, j = 0;
    long long int i = 0;
    __m128i lcpy[STATE_LENGTH * 2], hcpy[STATE_LENGTH * 2];
    for (i = 0; !incr(lmid, hmid); i++) {
        for (j = 0; j < STATE_LENGTH; j++) {
            lcpy[j] = lmid[j];
            hcpy[j] = hmid[j];
        }
        transform64(lcpy, hcpy);
        if ((n = check(lcpy + STATE_LENGTH, hcpy + STATE_LENGTH, m)) >= 0) {
            seri(lmid, hmid, n, nonce);
            return i * 128;
        }
        int stop_=readStop();
        if (stop_) {
            return -i * 128 - 1;
        }
    }
    return -i * 128 - 1;
}
*/

fn transform64(lmid: [u128; STATE_LENGTH], hmid: [u128; STATE_LENGTH]) -> ([u128; STATE_LENGTH], [u128; STATE_LENGTH]) {

    let mut lfrom: [u128; STATE_LENGTH] = lmid;
    let mut hfrom: [u128; STATE_LENGTH] = hmid;

    // TODO ???
    let mut lto: [u128; STATE_LENGTH] = [0; STATE_LENGTH];
    let mut hto: [u128; STATE_LENGTH] = [0; STATE_LENGTH];

    for round in 0..26 {
        for j in 0..STATE_LENGTH {
            let t1 = INDICES[j];
            let t2 = INDICES[j + 1];

            let alpha = lfrom[t1];
            let beta = hfrom[t1];
            let gamma = hfrom[t2];

            // (alpha | (~gamma)) & (lfrom[t2] ^ beta)
            let nalpha = (!alpha) & gamma;
            let delta =  (!nalpha) & (lfrom[t2] ^ beta);

            // ~delta
            lto[j] = (!delta) & H_BITS_128;

            // (alpha ^ gamma) | delta
            hto[j] = ((!alpha) & gamma) | delta;
        }

        let lswap: [u128; STATE_LENGTH] = lfrom;
        let hswap: [u128; STATE_LENGTH] = hfrom; 
        lfrom = lto;
        hfrom = hto;
        lto = lswap;
        hto = hswap;
    }

    for k in 0..HASH_LENGTH {
        let t1 = INDICES[k];
        let t2 = INDICES[k + 1];

        let alpha = lfrom[t1];
        let beta = hfrom[t1];
        let gamma = hfrom[t2];


        let nalpha = (!alpha) & gamma;
        let delta =  (!nalpha) & (lfrom[t2] ^ beta);

        // ~delta
        lto[k] = (!delta) & H_BITS_128;

        // (alpha ^ gamma) | delta
        hto[k] = ((!alpha) & gamma) | delta;
    }

    (lto, hto)
}


fn incr(lmid: [u128; STATE_LENGTH], hmid: [u128; STATE_LENGTH]) -> bool {

    let mut c: [u64; 2] = [0; 2];

    let mut lmid_copy: [u128; STATE_LENGTH] = lmid;
    let mut hmid_copy: [u128; STATE_LENGTH] = hmid;

    let mut i = 5;
    loop {
        //i < HASH_LENGTH && (i == 5 || c[0] )
        if HASH_LENGTH <= i || ( i != 5 && c[0] == 0) {
            break;
        }

        let low = lmid_copy[i];
        let high = hmid_copy[i];

        lmid_copy[i] = high ^ low;
        hmid_copy[i] = low;

        let carry = (!low) & high;

        // TODO safe?
        c = unsafe { std::mem::transmute::<u128, [u64; 2]>(carry) };

        i += 1;
    }

    i == HASH_LENGTH
}


fn incrN128(n: i64, lmid: [u128; STATE_LENGTH], hmid: [u128; STATE_LENGTH]) -> ([u128; STATE_LENGTH], [u128; STATE_LENGTH]) {
    let mut c: [u64; 2] = [1; 2];

    let mut lmid_copy: [u128; STATE_LENGTH] = lmid;
    let mut hmid_copy: [u128; STATE_LENGTH] = hmid;

    //__m128i carry;
    //let mut carry: u128 = 0;

    for _j in 0..n {
        //carry = 0xFFFFFFFFFFFFFFFF_FFFFFFFFFFFFFFFF; //_mm_set_epi64x(HBITS, HBITS);
        let mut i = HASH_LENGTH - 7;
        loop {
            // TODO wrong condition?
            if i >= HASH_LENGTH || c[0] == 0 {
                break;
            }

            let low = lmid_copy[i];
            let high = hmid_copy[i];

            lmid_copy[i] = high ^ low;
            hmid_copy[i] = low;

            let carry = (!low) & high;

            // TODO safe?
            c = unsafe { std::mem::transmute::<u128, [u64; 2]>(carry) };

            i += 1;
        }
    }

    (lmid_copy, hmid_copy)
}
/*
void incrN128(int n, __m128i* mid_low, __m128i* mid_high)
{
    int i, j;
    alignas(16) unsigned long long c[2]={1,1};
    __m128i carry;
    for (j = 0; j < n; j++) {
        carry = _mm_set_epi64x(HBITS, HBITS);
        for (i = HASH_LENGTH - 7; i < HASH_LENGTH && c[0] ; i++) {
            __m128i low = mid_low[i], high = mid_high[i];
            mid_low[i] = _mm_xor_si128(high,low);
            mid_high[i] = low;
            carry = _mm_andnot_si128(low,high);
            _mm_store_si128 ((__m128i*)c,carry);
        }
    }
}
*/

//const H_BITS: i64 = 0xFFFFFFFFFFFFFFFF;
//const L_BITS: i64 = 0x0000000000000000;


fn para(mid: [i8; STATE_LENGTH]) -> ([u128; STATE_LENGTH], [u128; STATE_LENGTH]) {

    let mut lmid: [u128; STATE_LENGTH] = [0; STATE_LENGTH];
    let mut hmid: [u128; STATE_LENGTH] = [0; STATE_LENGTH];

    const H_BITS_128: u128 = 0xFFFFFFFFFFFFFFFF_FFFFFFFFFFFFFFFF;
    const L_BITS_128: u128 = 0x0000000000000000_0000000000000000;
    
    for count in 0..STATE_LENGTH {
        if mid[count] == 0 {
            // _mm_set_epi64x
            // int64 b, int64 a -> int128 a_b
            lmid[count] = H_BITS_128;
            hmid[count] = H_BITS_128;
        } else if mid[count] == 1 {
            lmid[count] = L_BITS_128;
            hmid[count] = H_BITS_128;
        } else if mid[count] == -1 {
            lmid[count] = H_BITS_128;
            hmid[count] = L_BITS_128;
        }
    }

    (lmid, hmid)
}


#[cfg(test)]
mod tests {
    use super::*;

    const SYMBOLS_TRITS_EXPECTED: &str = "MPMZZPPZMMMPMZZPZPZPMZPMMPPPZMMPMPZMZMZZZZMPPPPMMZMPMPZMZPZMPMZPMZZPPMMMPPZZZPMPZPZPPPZPPMZZMMZZPZMZMMZMPMMPMZPMMZPZPPZMPPZMZZZPPMMMZPMZPMMMMMPZPPZZPPMZPZPMZMMPPZMMPPMPZMPMZZMZMMPMMPPZMMMMPZMZZPMPPPPPPMZMMPMZMMZZMMMPZPMMMZMZMZPZPZMPMPPMPMMZZZMMPPPZZZPPMZMPPZPPZMZZZPZMZMMMMZZZZPPMPZZZPMMPPPMMPPMPZZMPPPZZPZMMZMPZZZPPPZMMZPPZZZZPPZPMPPPMZMMPZPPPMZPZMMMZPMMMMMMZPPZPPZMZZZMPZPZZZPZMMZZPZPZMZZMZZZMPZZZMPPZZPPZZPMZPPZZPZPZMMPPPZPMMZMMPZZZZZZZPMPMMPMMZPPZPMMZMPMMZPMPZMMMZMPMPPZMPPMPMPZMPZMMPMPZPPZZMZMMMMPMZPZZMPMZPMMPMZMZMZZPMMPZZZZZZPZZPZPZPZZMZZMMMMZZPZZMMMZZMZMPMPZZZZMZZZMMPZPZPPMPMZZMZZPZZZZPZZZMMMZPZMZMZPPMZPPMZMMPZMZZZZPPMMZPPZZPMZMMMZPZZZPZMPPZZPMPZZMZMMPZMMPPMZMPMPPPPZPZZPPPPZPMMZPPZPMPMPMPZPMPZMMZMMPMZMPPMMZZMZPPZPPZMZZZPPPZMPPZMMPPMMZZPPPZMMMMMPZPMZPZMZPMMZPZPPZZZZZMPPMZZPPMMZZZZPMMMMMZZZZPPZPPPMMMZMMPZPZPZZMPZMMMPMPPPPMMPPMPPPZPMPZZZZPZPZZMMPMMZZZPZZMZPZMPPZMPZPPPPZPPMZPZZMPPPPZZMZZZZZZZMMPPMPMMMZPPZMPMZZPMMMPPZZPPZZPPZPZPMZMMMPZZPPPPZPZMPPZZMZMPMZMMPPZZPMZPPMPZPZPZPPZZMZPPMMZPPZZZPZPZMPPZPZMPZZZPMMMZPZZMMPPPMMZPZMZPMPZPMMMMMZZZZPPPMZMZMPZMZPZZZZMPMZMZZMMZMZPZZZZPZZZMMZMPZPPZZZPMPZMMMPMPZMPPMMZPPMZMPZMZZZMPZMZPMPMMMPPPMZZMZMMPPPZPZPZZZMZZMZPZZZMZPMMPPMMPZPZZPMMZZZZPMZZMPZPZMZZZPPPMMZZZMZZZPMMZMMZZPZPPPPPMPPZZMZPMPPZZZMPMZZZMMZZPZZMMPMPZPZZPPPPMMMZZPMZZMMPPMMPMPZMPPPPMMZZMZMMZZMMMMZZZMPPZZPMPPPMZPZMPZZMMPPZPPZZZZPPPPMZZZPPMPZPMZMZZPZZMMZZPMMPPMPZPPZMPZMMPPMZPZMZMZPMZPPPMMZZZPPZZMMZZPMZMZPPMPMMZMZMPZZPPMZPPZZZMPZPPPMMZMPPMPPZMPPMPMZZMZMMMPPMZPZPMMMZPZPMPZZMZMMPMZPMZPPZZZPPPZZPMZPPMZMPPMPZMZMZPMPPPMZPPMPMMPMMZZZZMZPPPMMPZMMPPPMMPPMZZPZPMZZMPZPZZZZPZPZPMPZMPMMMMPZZPMZZPZPMMMZPMZMMPMMMZMPMMPMMPPMZPZMZPMMPZZMPZMPMPMZPMZZPZZPZPPMPZZMZZPZZMPMMMPPPMMMPPPZZZZPMMMPZPZPMZMMPMMMMZMMMZMMMPMZMMZMMPZMPMPZMPZZMPMMZZPZPMPMPPMZPMMPMMZZPMMZPMMMZPPZPMZMPPZZMZMMMPZZZMZMMZPMPPMPZMPMMPPPPPZZPPZPMPPPMMPMZZMMZPPPPMMMMPPZMMMPPPPMZMPMMPZMPPMMPMPPZMZZMPPPZZMPMZPMMPMZMMPZZMMPPPMMMZZPZMMZZZZMZPZZPMPPMPPMZPPPPZMMMZMPMZPZPZMMZPMPMZZPPMPMZMPPMMMMPZZMPZMMPPMPZPPMMMZPZZZZMMZPPMPPZPMMMMPPZPMMMZPMPZMPMZZPMZZMPZZZMMZPZMMPMMMPMZPMMPMZMMMZZPZPZZZZZPPZMPMZMMMPMZMMMPMMMMPPZZMPPMPPZZMMPPZZMPZMPPMPPMPZMPPMMPZMPZPPPPZMMPZPPMMPZMMPMZPMMMZZMPMZPZPPMMPPZMMMPZZZPMMZPZZZZZMZPMMZMPMZPZMZMMPMZZZZZPPMPPMZPPMZMPPZZZMPPZZZMMZPPZMMPZPPPPZZMPPZMZZMPPZPZMPZPMZZMMZPZPMMPMPMMPPMPPMPMZZZPPZZZZPZPMPZMPZPMZZMPPPZZZZMPPZPMPZZPPPMPZPPMZZPZPZZPZPPMMMPZMZMPZMMMPZZMZZPPMZMZMMMZZMMZPPMZPPPZZMZZZPMZMPZPPPMPMZMMMMZPZPZZPPMPZPMPMMPZPMPPPMZPPMZZMMPMPMMMPMPMMMZPMPZMZZPPPMMPZMPMMMMZPPPPPPPZZMMPPMPZMMZZMPZMPPZPMPPMMZPMPZMZMPZZMMZMZZZPZZPPMMMZMMZMZZZPZZMPMMMMPPPZMPZZMZPZZPMPPPZPZMMPPPMMPMMZZPZZPZZMPPMPPPMPMZPZMPPZPMZMMMZZPZMZPMZPMZMPMMPPPZPMPMZMMMPPMZZZPMPMPZPPMPPMMMMMPZMZMZPMMZMZMZZZMZPPPMZMPPPMPZPZPMPMPPZPPZPMMPPPZMZMPZZZPZMPMMMZPMMPZMZMPZMMZMMMMMMPMMMMZPZPZPZZMPPZMZMMPZPZMZPZPMPZMZPPMMPPMMZMZZZZPPMPPPZMPPZZZZZMPMPMZPMPPPZZMZPPZMMPMZMMPZPPPZPZPMMPMZPZZPPZZZMMZMPZZZPPPZMPZPPPZZMZZPZPZMZZPPZPMPMPMZMZPMPZZZPMPMPMPPMZMPMPMZMZZPZMZZMZMMMZPPPZZPMMZZMMZMMMMMPMMMMPPMPPZPMPZMZPPMMZZMPZPZMMMPZMPZMZPPMZZMZZMZZZMZZMZMZZPMZZMMPMMZPMMZMZMZZZMPPPPZMZZPPPZPZMPMPMZMPMPPMMPPMMPMMPZZZMPPZPMPMPPPMPZZPPMPZMMZPMZPZZMMZPZPMMPZZPMZPZPMMMMPZZMPMZPPZZZMMPMZPZZPPZPMZMMPMZPZZPZPPPMZMZMPMZPZZPZPPPMPMZPPMPMMPPPMZMZMPPMZPPPZZPZMMMPPPPZZMZPPPZPMMZPMPMPMPZMZMPMZPMZMPZZMPZZZZPZZZMZZPMPPPPZPPMMZZMZZZZZMPPZZPZMPMMPZPPZPMZPMMPPPMMZMZPMMZZMZZPZMPPPMMPMMZZPMMZMZZZMMPZMPPPZPMPZZZMZPPMMPPMPZPMPZPMPPZMZMZZPMMPMZPMPZMZZZMMPPZMMPZZMZPZZMZMMZMPZMZMMPMMMPZZZPMPZZPMZZMMPZMMZMMPZPZPPMPPPPPPPMZPZZPPPZZPMMMMPZMPMZPMZPMPMZMPZMPPZPZPPPZMPPPPPPMMMMMMPZPMMMPMZPMMMZPPPZZPPMZMZZZPZMMZPZZMPZPMZZPPPPZPPPMPMZMZPZZPMPMMZZMPPMZMMPZMZZZMPMPZPPZMMPMZPPMPMMMMMPZMZMMPPMPMZZZPMPMMMPPMMZPZZMZPPPMPMPPPPMMPPMZPPMPZMZMPMMMPZMMMMZMZPMMPZZZPMPMMMPPPPZZZZZZMPPPPMZZMMPMPMMMMMPZZPZZMMZPMMZZMZZZZZMMZMPMZMPZZPPZMPMZZPPZPPMMMZPMZPPZPZPZMZMZMZZMPMPMPMPPMPZZZMPPPMMMPZZZZZZMPPMMPZZZPMZPZMZPZMMPMPMMPZZZPMMPZPPZZPMMZPMMMPPMZZPMZZMPPZZZZMPZMPMMPPMZPPMPMPPZMPPMMPPZZMPPZPPZPZMPPZPMZPPMZZMZPZPPMPPZMMMZMMZZPPPPPMZPPZMPZPPZMPZZZMZMMZPMPMZZZZPPZPPPZMZZZMZMMZMZMMPPZPZMZMPPMZZPMZZPPMMMPPPZMMPZPPMPZMMPPPZZPZPPPPPPMMMZZZZMZMZPMZZPZPPMZMPZMMPPMZPMZZPPPPZZZMZPMPPPMMZPZPMPZPMPZPPPMPMPZZMPMPMMZZPPPZMZPPZPPPMZPMMPZMZZMMZZPMZMMPMZMMMZMMZMMPPPMMPPZPPPMZMMZPMZMZMZPPZZZPZZPMMZPPPZPPMMPPMZZZZZMZZPPZMPMPZMZZPMZPMZMZMMMPMZMMPPMZPMPPPMMPZZPPZMPPPPZZZZZPPMMZZZZPZMPMZMMPMPMMMPZZMZZMZPPZMZPPPZZPPPPMZPPMPPMZZMZZMZPZPPPMZZPPPMMZZPMMPZZZPZMMPPZMMMMPPZPZMZPZZZMPPPZMPPZZPZPZZMMPMZZZPZMMPPMPPMPZZMMPZMZZPZZZZPPMMZZPZMZMPPZMPPZMPMPZMMZPPPMMMPZMMPZMMZPZZPMPMZZZPZPMZPPPPMPZMPZPMMMZMMPMZZMPMPZMMZZMMMPZZPPMZMZMPZMMPZZPZPPPMZPPZPMZMZZPZMZMPMMPMMZMMMZZMMZPZMPPPPPZPZPZMPMPMPZZZMMPMPZPZZMZZMPMZMMZPMMZMZPZZPMPMMPZPPZZPZMPPMMPMPZZZPMZZMZZZZZMPMMMMMMPMZPMPPZMPZPZMZPZPPMZMPMMZPZZPPPPMMZPZMZMZMZZMZPZZZPZPMZMZZPPMZZMZMPPZMPZMZMMPZMMMZPZMMMMPZZZPMZMMMMZPPZPZZPPPZPZZPZPZPMPMPPMMMMPMMMMZZMZPZMMZZPZMPMMPMZPMPZPZMZPZMZMZZPMPMPPMZMPMZPZPMZMMMMPPZMPPMZMZZMMPZPPMMZPZMMMMPMZPMMZZZZMZZZZPPPPMMZMZPZZMZPMZZPMMMZZZZPPZZZPMPMMMPZMZPMMPMPZZZMPPMMZPMZPPPMPZMZZMZMMZMZPZMMPPZMMMMZMPPPMZPMZMMMPZMZMPMPZPZZZMZZMMPPZMPMZPZMMMMPMPPMPMMZPPPZMZPZPMMMMZZMZMZPZZPPZZMZZPMPPPZPZMMZZMPPZPPPPMZZMPMPPPMZPMMMZZZPPMMMZZPPMZZPZZMPMMPZZZZZMPZMPZZZMZPMPZPMPZPPZMPZZPMPMMMMMMMPPMZMPZPZMZMZZPZPZPMMZZMPZMPMPPPMZMPPZZPZZMPMMMZPMZPZPMPMZZZPMPZPMPZPZZPPZZMZPMMMMMMPZPMPZMMPZPZPMZPZMMMZPZMPMPMMPPZPPMZZPPMZPPZPPMMZPMZMMPMZMMPPZMZPPPPMZZPMMPZPPMPZPPPPZMZPPZZMMZZPZPZPPPMMMPPPPZMPPZMPPMPPZZPZPPZMPZMMMZMZZZPZMZMPPZZPPZMPPPZMMPZMZMMZPZZPMMZZPZPPMZPZPPMMMMZPMPPZPZZZMPPPPMMZPPMZMZPMPMZMMPPZMPZZMMPZZPMMZMMZMMMMPZZPZMMPZZPPMZPZMZMMMZPMPPPMMZZPZPPMPMZMZPMMPZZZMPZZPMZZZZZPZPPPPMPPZMPMPPPZPMZPMPMZPPMZPZZMMZPPMPMZZMZMZPPZPZMMPPPMPZPPZPPPPPZPMZPMMZMPMZPMMPPPPPMPPZMMMMZMPMMZZMMZPMPPPMMZZPMPMZMPZZZMMPZZMPPPPMPMPZMZMZZMMPMZZMPZPPPPMZPMMPPMMMZZPMPMPPMZPZPMPZZZPZMPZMZMPZPZZZPZMZZZPPPZZPPZZMPZMPMPZMZZZZPZMZMPPMMZPZMMZZZPPPPZZMMZPZPMPZZMMZMPZZMZZPPZZPZZMPPMMZZMPZZMZZPMZZMZZPMPPPMMMZZMPZPZZZZPMMPPZPMMPPZZMPZZPPMPZMPPMPPPZPZMMPMMMPPZPZPPZZMPZMZZZZPMPMPPZMZMZPPMMMZPZZMZMZZMMMZMZZPZZMMMZPMPPZPPPZZMPMZMPZMPZMZMPPPMMZZZZMPZMPPPZPMZPZMPZZZMZZZPPZMZZPPZMPPPPPMPMZPMMZMZPMMMMZPMZPMMPPMMMPPZZPMZZZMMMMPZZZZPMPMMMZPZPPZMMPMPMPZMZZZMPZZPPPPPPMZZZZPMZZZMPZZZZZPZPMZMMZZMZZMMMPMMZPZMZMPZPMMMMMZZZMMZMZPPZPPMZPZPPPMPZMZZPZPPZZMMPMPMZZZPMMPPMMZPZPZMZMMPMPPPPPZMPMPPMPPMZMZZPPZMZPPZZZPZMZZMPPZMMZPPMMZMZMMZMPPMPZMZZMPZPPZPZPPZZPZZZMZPZMPPZMMPZMPZMZPMMPZZZZMMPZZPMZZZPMPPZPPZPPZZMPZPMMPPPZPZPPZZZZZPPPMPMZMPZPZPPZZMZZPPMZMPPPMPMZMZMMZZMPMPZPZPPZPPZPZZMPZPZZZZPPZZMZMZPZZZZPPPMZZPPZMZMZPPZMZZMPPZMPZZZMMZPPMMMPMZPPPMMZZPZPZPZMMPPZMMPMMPZPMPZMZZPMZPMMPPPMMZPMZMPMMPZZZZPZMPMZMZPPZZZMMPZPZMPZMPZPPMMZZPMMMZPPMZZPMZZZMZPPPZMPZZMMPMZZMZMPMMPPMMZZMMZZPZZMPMPMZPZPMPZPPPPPPMPPMZZZZPMMPPMZPMZPZZMMMPPPZZZPZPMZZZZPZZZMMZZZMPZPMMZZMPPPZZPPPZPMPPMZZMZZPMMPPPPMPPMMPMPPZZPPPPPZZPMPZMZPZMPPPPMPMPMMMPPZPMMZZPZMMZMMZPZZPPPZZMPMMMMZMMMZZPMMMMPMMMPMPMZMMMPMZZMPPPZMMPPZMPMZMMZZMPPMMMPZPMZZMZZMPMZZZZZZMMPMPPZPMZMZMZZPMMPMMZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZPZPPPZZMMPPMZPMMZPPZZZZZZZPZZZZZZZZZZZZZZZZZZZZZZZZZZZPZZZZZZZZZZZZZZZZZZZZZZZZZMPMMMMZMPPZZMPPPPMMPZZMPMZPMZPPPPMPPMZMMPPMPPPZMMMMPZPZZMZPPPPZZZPPMZZPMZZPPMPZMMPPPMMPZMMPZZPPZPZPZPPMMMPZMZZZPZPPMPMPPPMPZPMZZPMZPMZZMZPZZPZPMPPZMMMMZMPPPPPMPMZZPZPZZZZZPZMMZZZPZZPPMZMZMMMMPPPMPZPPMMZPMPMPMZMPMPMMZMPMPPPMMPMPMZPPPMPPPPZPMMZMPPPPZZMPPMZPMZPMZPMZPMPMMPZMZPPPMMMZPMZPZMPZPPZMZMZZZMPPMMPZZZMPPPMZPPPMPPMZZZMMZZPMMPMMMMPPPMMMZMPPPMPPZMMZZPPMZPMZMPMPZMPMMPZPPMPMMPPMZZZMMZZPPZMZZMMMPPMMZPMPZPZMZMMMZZMMPZZZPPZZMZMPPMMZMMMZZPZZPZMPPMPZZZZPPZMMPMZZMMPZMZPZMZZZZZZZZZZZZZZZZZZPPPZZZMMPMZZPMPZZMZMZPZPZZZMMZPMZPZMMZZZMZMMMPPZMZZMPZPZZPZPMZZPPPPZPZZZPPMPZZPPPZPMMMZMMZMMZPZZMMMPMPZZPPPMZMPMPPZPZZPMMMMZZMMPZZZZPMPZPPMZZMZZMPPZZMZZPPPPMMPZMPZPMMPPZZZMPPMMPZMPMZZZMZPMZPPZPMPMPZMZMPZPZZPZPMZZZPZMMZMZPMPPPZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ";
    const SYMBOLS_MID_EXPECTED: &str = "PPPMZMMMPZMZMMMZPMZPMZPMMMZPMPPZZMMMMMZMPZPZZPZPZZMZMMPZMMZMPMPMZZPPPMZZMZZZMPPMZPMPPMMMMPPPMPPPZPMPMMPPZZPZZZZPPZMPZPZPMZPPPPMMMMPZPMPZPZMZPZPZMMMPZMPMPMZZZPPMPZZPZMPMPPMZPMPMZMPZZZZMMZPZZZZMZZPPMZZMZZPPMPMMMZPPMPMZMZPPZPZPPPZMMZZMZPPMMPMMPZPMZMMMZZMZMPPZZMZMPMMZZPZZZZPZPPMPZMPMZMPPPZZZPPZMPPPPZZPZMZPMMZPPPZMMPMZPZZMMMPZZZMZPMPMZMZZMPPPZZZZMMZMMMMZPZPZZZZMMZPMPZPPMMZPMPMPPMZPPPPMPPPPPMZMMZZZZZMPMZMZPPMMMZMZMMMZPMPZPMZZPZZZMMPMPZZPZZZZMPPMMPMPZMPPPPMPMPZZPPPMPMPPZPZZMPMZMZZZZZZZPPPMZZPPZMPZZZPPPPPPMZZPPMMZPMMMZZMPZMPPPZMPMPMPPMMZZZPZZZZMMPZZZMZPMPZPPZMZMZMZZPZZZMZMZMPMZPPZPPMPMPZPPMPPZPMMPZPZZZZMPPZMMZZPMPPZPMPZZMMZMZZMMMZZPZPMMZMPMZMZMMPZZMZPZMMZMPMPZMMMMMZPMMMMMMZZZPPZPZPPZPPPMZPZPMMMPZMMZZPZPZPPZZPPZPPMPMZMMPPZPZPZPM";

    const HASH_EXPECTED: &str = "MQEXNUUUWGANWBAJROSQGZMZZFYGPEVMUPDC9DBJHMNBGCHCNSGZLBCTVUYB9WARIYXLTWVYHJLSZHPPJ";
    
    #[test]
    fn test_const() {
        assert_eq!(TX_LENGTH, TX_STRING.len());

        assert_eq!(TRITS_LENGTH, SYMBOLS_TRITS_EXPECTED.len());
        assert_eq!(STATE_LENGTH, SYMBOLS_MID_EXPECTED.len());
        assert_eq!(TRYTE_LENGTH, HASH_EXPECTED.len());
    }

    #[test]
    fn test_tx2trit_to_hash2tryte() {

        // tx2trit
        // TX(string TX_LENGTH:2673) -- string to [u8] --> TRITS(-1/0/1 TRITS_LENGTH:TX_LENGTH*3)
        let trits = tx2trit(TX_STRING);
        let symbols_trits = trits2symbol_tryte(trits);

        assert_eq!(SYMBOLS_TRITS_EXPECTED, symbols_trits);
        assert_eq!(TRITS_LENGTH, symbols_trits.len());

        // absorb(and transform)
        // TRITS -- [u8] to [u8] --> MID(-1/0/1 STATE_LENGTH)
        let mid = absorb(trits, TRITS_LENGTH);
        let symbols_mid = trits2symbol_mid(mid);

        assert_eq!(SYMBOLS_MID_EXPECTED, symbols_mid);
        assert_eq!(STATE_LENGTH, symbols_mid.len());

        // STATE_LENGTH : 3 * HASH_LENGTH

        // absorb(and transform)
        // MID -- [u8] to String --> TRYTE(9+A-Z HASH_LENGTH / 3)
        let tryte = hash2tryte(mid);
        let symbols_tryte = tryte2symbol(tryte);

        assert_eq!(HASH_EXPECTED, symbols_tryte);
        assert_eq!(TRYTE_LENGTH, tryte.len());
    }

    #[test]
    fn test_para() {
        const MID_EXPECTS: [i8; STATE_LENGTH] = [-1,-1,1,0,0,-1,0,1,0,0,1,0,0,1,0,1,-1,0,-1,1,-1,1,0,1,0,-1,0,-1,1,1,-1,1,-1,1,0,1,-1,0,-1,1,1,-1,1,-1,1,0,1,-1,-1,0,1,0,1,-1,0,1,1,-1,-1,1,-1,1,-1,-1,0,-1,-1,-1,1,-1,0,0,0,1,0,0,-1,0,1,1,-1,1,0,-1,0,1,1,-1,1,1,0,-1,1,-1,1,-1,0,0,0,-1,-1,1,1,1,-1,-1,1,-1,0,-1,-1,-1,0,0,1,0,-1,1,0,-1,0,0,0,-1,1,1,1,1,1,1,1,0,-1,-1,0,0,1,0,-1,0,-1,0,0,-1,-1,-1,0,1,0,0,0,-1,1,1,0,0,-1,-1,-1,1,0,-1,-1,-1,1,0,1,0,-1,-1,0,1,-1,1,0,1,0,-1,0,-1,1,-1,1,0,1,0,0,1,1,0,1,1,-1,1,-1,1,0,0,0,0,-1,1,1,0,0,0,0,-1,1,1,1,0,-1,-1,0,0,-1,1,-1,0,-1,0,0,0,0,1,0,0,1,-1,-1,1,1,-1,-1,-1,-1,1,1,-1,1,1,-1,0,0,1,0,1,1,0,-1,0,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,1,1,0,1,-1,1,1,-1,0,-1,0,-1,1,-1,-1,-1,1,-1,0,0,1,0,-1,-1,1,0,-1,0,0,1,0,1,-1,-1,1,-1,1,-1,0,0,0,0,0,-1,-1,0,1,1,1,1,1,1,1,1,1,1,0,0,-1,0,0,-1,-1,-1,1,-1,-1,1,-1,0,-1,1,1,0,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,1,1,0,1,1,1,-1,1,0,-1,-1,0,0,1,1,-1,-1,-1,1,-1,-1,1,1,0,1,1,1,-1,0,0,-1,1,-1,-1,1,0,-1,1,0,0,0,-1,0,-1,1,1,0,1,-1,1,-1,0,1,0,1,-1,1,-1,0,0,0,0,-1,-1,0,-1,-1,0,-1,1,1,1,0,1,-1,0,0,1,1,0,1,1,-1,1,-1,0,1,0,-1,1,0,0,0,1,-1,0,-1,1,0,-1,-1,-1,-1,-1,0,1,1,0,0,1,1,1,1,1,1,0,-1,0,0,1,0,1,0,1,1,0,1,1,0,-1,0,1,0,0,0,1,1,0,0,1,0,1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,1,0,-1,0,1,-1,0,-1,-1,-1,0,-1,-1,-1,1,1,0,1,1,0,0,-1,0,1,1,0,0,1,0,0,0,0,-1,-1,0,-1,0,-1,1,-1,-1,1,-1,0,0,0,-1,-1,-1,1,1,0,-1,0,-1,0,1,1,-1,0,-1,1,1,0,-1,-1,0,0,1,0,1,1,0,1,-1,1,1,1,1,0,0,-1,1,1,-1,1,1,0,-1,-1,0,0,-1,1,0,0,1,0,-1,1,-1,0,1,-1,1,1,1,0,0,1,0,1,-1,0,0,1,0,-1,1,-1,0,1,0,1,-1,0,-1,-1,1,0,-1,-1,1,-1,0,0,0,-1,0,0,0,0,1,1,-1,0,-1,1,-1,-1,1,-1,0,1,1,0,-1,1,-1,0,-1,-1,-1,0,1,0,1,0,0,-1,-1,0,-1,0,0,0,0,-1,0,-1,-1,1,1,-1,-1,1,1,0,-1,1,1,-1,0,-1,-1,1,1,-1,1,0,0,-1,0,-1,1,-1,1,-1,1,1,1,0,-1,-1,-1,-1,-1,1,0,-1];

        const LMID_EXPECTED: [u128; STATE_LENGTH] = [0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff];
        const HMID_EXPECTED: [u128; STATE_LENGTH] = [0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0x0000000000000000_0000000000000000,0xffffffffffffffff_ffffffffffffffff,0xffffffffffffffff_ffffffffffffffff,0x0000000000000000_0000000000000000];

        let (lmid, hmid) = para(MID_EXPECTS);

        for count in 0..STATE_LENGTH {
            assert_eq!(LMID_EXPECTED[count], lmid[count]);
        }

        for count in 0..STATE_LENGTH {
            assert_eq!(HMID_EXPECTED[count], hmid[count]);
        }

    }

    // Test Utils
    fn tryte2symbol(tryte: [u8; TRYTE_LENGTH]) -> String {
        let converted: String = String::from_utf8(tryte.to_vec()).unwrap();
    
        converted
    }

    fn trits2symbol_tryte(trits: [i8; TRITS_LENGTH]) -> String
    {
        let mut trits_symbol: [char; TRITS_LENGTH] = ['0'; TRITS_LENGTH];
        for count in 0..TRITS_LENGTH {
            trits_symbol[count] = trite2char(trits[count]);
        }

        trits_symbol.iter().collect()
    }

    fn trits2symbol_mid(trits: [i8; STATE_LENGTH]) -> String
    {
        let mut trits_symbol: [char; STATE_LENGTH] = ['0'; STATE_LENGTH];
        for count in 0..STATE_LENGTH {
            trits_symbol[count] = trite2char(trits[count]);
        }

        trits_symbol.iter().collect()
    }

    fn trite2char(trite: i8) -> char {
        
        let trite_symbol;
        if trite == -1 {
            trite_symbol = 'M';
        } else if trite == 1 {
            trite_symbol = 'P';
        } else if trite == 0 {
            trite_symbol = 'Z';
        } else {
            panic!("unknown trits {}", trite);
        } 

        trite_symbol
    }

    fn symbol2trits_mid(symbol: &str) -> [i8; STATE_LENGTH] {
        let mut trits: [i8; STATE_LENGTH] = [0; STATE_LENGTH];

        let mut count = 0;
        for trite in symbol.to_string().chars() {
            trits[count] = symbol2trite(trite);
            count += 1;
        }

        trits
    }

    fn symbol2trite(symbol: char) -> i8 {
        
        let trite;
        if symbol == 'M' {
            trite = -1;
        } else if symbol == 'P' {
            trite = 1;
        } else if symbol == 'Z' {
            trite = 0;
        } else {
            panic!("unknown trits {}", symbol);
        } 

        trite
    }


}